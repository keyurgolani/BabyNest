# BabyNest Docker Environment Configuration
# Copy this file to .env and customize for your deployment
#
# Usage:
#   cp .env.example .env
#   # Edit .env with your values
#
# Development: docker compose -f docker-compose.dev.yml watch
# Production:  docker compose up -d

# ===========================================================================
# Container Registry Settings (Production Only)
# ===========================================================================
# Registry to pull images from (ghcr.io or docker.io)
REGISTRY=ghcr.io
# Your GitHub username or organization name
REGISTRY_OWNER=your-github-username
# Image versions (use 'latest' or specific version tags)
API_VERSION=latest
WEB_VERSION=latest

# ===========================================================================
# Application Settings
# ===========================================================================
NODE_ENV=production
API_PORT=3000
WEB_PORT=3001
API_PREFIX=api/v1

# ===========================================================================
# PostgreSQL Database
# ===========================================================================
POSTGRES_USER=babynest
POSTGRES_PASSWORD=change-this-password-in-production
POSTGRES_DB=babynest
POSTGRES_PORT=5432

# ===========================================================================
# Redis Cache
# ===========================================================================
# Leave empty for no password (development only)
# Set a strong password for production
REDIS_PASSWORD=
REDIS_PORT=6379

# ===========================================================================
# JWT Authentication
# IMPORTANT: Change these secrets in production!
# Generate with: openssl rand -base64 32
# ===========================================================================
JWT_SECRET=change-this-to-a-secure-random-string-at-least-32-chars
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=change-this-to-another-secure-random-string-at-least-32-chars
JWT_REFRESH_EXPIRES_IN=7d

# ===========================================================================
# Ollama AI (Optional)
# Model is automatically downloaded on first container start
# ===========================================================================
OLLAMA_PORT=11434
# Override OLLAMA_BASE_URL to use a remote Ollama instance (e.g., GPU server)
# Default uses the local ollama container: http://ollama:11434
# OLLAMA_BASE_URL=http://your-gpu-server:11434
# Available text models (auto-downloaded on startup):
#   - llama3.2:1b  (fast, ~1GB RAM) - Good for quick responses
#   - llama3.2:3b  (balanced, ~2GB RAM) - Better quality
#   - llama3:8b    (quality, ~4.7GB RAM) - Best quality, slower
#   - mistral:7b   (quality, ~4GB RAM) - Alternative high-quality model
OLLAMA_MODEL=llama3.2:1b
# Vision model for photo import feature (auto-downloaded on startup):
#   - gemma3       (vision, ~3.3GB RAM) - Preferred vision model, good balance
#   - llava        (vision, ~4.7GB RAM) - Alternative vision model
#   - moondream    (vision, ~1.7GB RAM) - Smaller, CPU-friendly alternative
OLLAMA_VISION_MODEL=gemma3

# ===========================================================================
# Frontend Settings
# ===========================================================================
# API_BACKEND_URL: Server-side env var for Next.js rewrites (runtime configurable!)
# This is the URL the Next.js server uses to proxy /api/* requests to the backend.
# For Docker: use the internal service name (http://api:3000)
# For external hosting: use the backend's internal/private URL
API_BACKEND_URL=http://api:3000

# NEXT_PUBLIC_API_URL: Optional - only set if you need direct browser-to-API access
# Leave empty to use the default relative URL (/api/v1) which gets proxied by Next.js
# This is the recommended approach for self-hosting as it works regardless of domain
NEXT_PUBLIC_API_URL=
NEXT_PUBLIC_BABY_ID=
NEXT_PUBLIC_API_KEY=

# ===========================================================================
# CORS Settings
# Add your frontend URLs here, comma-separated
# ===========================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:8081

# ===========================================================================
# Rate Limiting
# ===========================================================================
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# ===========================================================================
# Database Migrations
# ===========================================================================
RUN_MIGRATIONS=true
SEED_DATABASE=false
